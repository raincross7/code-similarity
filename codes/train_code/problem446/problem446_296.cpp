#include<iostream>
#include<queue>

using namespace std;

static const int N = 100;

int n,d[N],M[N][N];//d[]...?§??????????????????¢(-1?????°?????????)???M[][]?????£??\???????????§????????????

void dfs(int r) {
	queue<int> q;//queue??§?????????
	q.push(r);//?§?????????£??\
	for (int i = 0; i < n; i++) d[i] = -1;//??????????????????
	d[r] = 0;//?§????????????¢???0

	int u;
	while (!q.empty()) {//??¢?´¢???????????§??°?????????
		u = q.front();//u????????\?????????????????¢?´¢???????????£?????????????????£??\
		q.pop();//?????\???????????????????´????????????????

		for (int v = 0; v < n; v++) {//??£??\????????????????????????
			if (M[u][v] == 0) continue;//?§??????¨??????????????§?????°?????????????????´???????????????
			if (d[v] != -1) continue;//?§??????¨????????¢???????????£??????????????¢?´¢???????????£??????????????´??????????????????
			d[v] = d[u] + 1;//??????u????§??????¨??£??\?????????????????????????????¢1???1?????????????????????????????????+1???
			q.push(v);//?????\??????v?????????
		}
	}
	for (int i = 0; i < n; i++) {
		cout<<i+1<<" "<<d[i]<<endl;//??????
	}
}

int main() {
	int u, p, v;
	cin >> n;
	for (int i = 0; i < n; i++) {//?????????(d[]?????¢????????????dfs??§?±??????????????????§????????????????????????)
		for (int j = 0; j < n; j++) {
			M[i][j] = 0;
		}
	}

	for (int i = 0; i < n; i++) {//??????????????????
		cin >> u >> p;
		u--;//0?????????????????????
		for (int j = 0; j < p; j++) {
			cin >> v;
			v--;//0?????????????????????
			M[u][v] = 1;
		}
	}

	dfs(0);//??????0????§??????¨??????

	return 0;
}